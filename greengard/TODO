iaddr -> 2D array
All arrays allocatable
Remove constants from all arguments
Remove missuse of "size"

[Change when translating to C]
wavek -> K