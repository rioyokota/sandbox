Anm Pmax -> P
iaddr -> 2D array
ncrit -> P based, find optimal value
itable -> distance based
Xj=Xj*10 bug -> High wavek bug
All arrays allocatable

[Change when translating to C]
wavek -> K