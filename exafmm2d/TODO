non-recursive direct
calculate force
remove all headers
use printf for all output